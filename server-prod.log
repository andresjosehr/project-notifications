âœ… [5:42:10 PM] Scraping completado en 19281ms
ðŸ“Š Procesados: 8 | Nuevos: 0 | Errores: 0
[2025-07-09T21:42:10.717-04:00] [INFO] Workana daemon ejecuciÃ³n: 8 procesados, 0 nuevos, 19281ms
[2025-07-09T21:42:18.967-04:00] [ERROR] Uncaught Exception | {"message":"Packets out of order. Got: 0 Expected: 2","stack":"Error: Packets out of order. Got: 0 Expected: 2\n    at Parser._tryReadPacketHeader (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Parser.js:470:15)\n    at Parser.write (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Parser.js:33:29)\n    at Protocol.write (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Protocol.js:38:16)\n    at Socket.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:88:28)\n    at Socket.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:526:10)\n    at Socket.emit (node:events:517:28)\n    at addChunk (node:internal/streams/readable:368:12)\n    at readableAddChunk (node:internal/streams/readable:341:9)\n    at Readable.push (node:internal/streams/readable:278:10)\n    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)","code":"PROTOCOL_PACKETS_OUT_OF_ORDER"}
[2025-07-09T21:42:18.968-04:00] [ERROR] Error en uncaughtException | {"message":"Packets out of order. Got: 0 Expected: 2","stack":"Error: Packets out of order. Got: 0 Expected: 2\n    at Parser._tryReadPacketHeader (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Parser.js:470:15)\n    at Parser.write (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Parser.js:33:29)\n    at Protocol.write (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/Protocol.js:38:16)\n    at Socket.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:88:28)\n    at Socket.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:526:10)\n    at Socket.emit (node:events:517:28)\n    at addChunk (node:internal/streams/readable:368:12)\n    at readableAddChunk (node:internal/streams/readable:341:9)\n    at Readable.push (node:internal/streams/readable:278:10)\n    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)","code":"PROTOCOL_PACKETS_OUT_OF_ORDER"}
[2025-07-09T21:42:18.969-04:00] [INFO] Iniciando cierre graceful del sistema...
[2025-07-09T21:42:18.972-04:00] [ERROR] Error en consulta SQL | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at /var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:149:17\n    at Array.forEach (<anonymous>)\n    at Pool.releaseConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:148:37)\n    at Pool._removeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:277:8)\n    at Pool._purgeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:258:8)\n    at Ping.onOperationComplete (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:101:12)\n    at Ping.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:526:10)\n    at Ping._callback (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:488:16)\n    at Sequence.end (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:83:24)\n    at Sequence.OkPacket (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:92:8)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.sendCriticalErrorNotification (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:122:38)\n    at ErrorHandler.handleError (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:38:12)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.973-04:00] [ERROR] Error obteniendo usuarios activos | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at /var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:149:17\n    at Array.forEach (<anonymous>)\n    at Pool.releaseConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:148:37)\n    at Pool._removeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:277:8)\n    at Pool._purgeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:258:8)\n    at Ping.onOperationComplete (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:101:12)\n    at Ping.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:526:10)\n    at Ping._callback (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:488:16)\n    at Sequence.end (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:83:24)\n    at Sequence.OkPacket (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:92:8)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.sendCriticalErrorNotification (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:122:38)\n    at ErrorHandler.handleError (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:38:12)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.973-04:00] [ERROR] Error verificando estado de usuario | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at /var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:149:17\n    at Array.forEach (<anonymous>)\n    at Pool.releaseConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:148:37)\n    at Pool._removeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:277:8)\n    at Pool._purgeConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:258:8)\n    at Ping.onOperationComplete (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:101:12)\n    at Ping.<anonymous> (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:526:10)\n    at Ping._callback (/var/www/projects/project_notifications/node_modules/mysql/lib/Connection.js:488:16)\n    at Sequence.end (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:83:24)\n    at Sequence.OkPacket (/var/www/projects/project_notifications/node_modules/mysql/lib/protocol/sequences/Sequence.js:92:8)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.sendCriticalErrorNotification (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:122:38)\n    at ErrorHandler.handleError (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:38:12)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.973-04:00] [WARN] Usuario inactivo, no se enviarÃ¡ notificaciÃ³n | {"user":"andresjosehr"}
[2025-07-09T21:42:18.973-04:00] [INFO] [TELEGRAM] NotificaciÃ³n de error enviada | {"context":"uncaughtException","user":"andresjosehr","success":false}
[2025-07-09T21:42:18.974-04:00] [INFO] [DATABASE] Pool de conexiones cerrado correctamente
[2025-07-09T21:42:18.974-04:00] [ERROR] Error en consulta SQL | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at Pool.getConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:25:15)\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:202:8)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.975-04:00] [ERROR] Error obteniendo usuarios activos | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at Pool.getConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:25:15)\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:202:8)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.975-04:00] [ERROR] Error verificando estado de usuario | {"message":"Pool is closed.","stack":"Error: Pool is closed.\n    at Pool.getConnection (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:25:15)\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:202:8)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    --------------------\n    at Pool.query (/var/www/projects/project_notifications/node_modules/mysql/lib/Pool.js:199:23)\n    at /var/www/projects/project_notifications/lib/database/connection.js:75:17\n    at new Promise (<anonymous>)\n    at DatabaseConnection.query (/var/www/projects/project_notifications/lib/database/connection.js:70:12)\n    at UserRepository.findActive (/var/www/projects/project_notifications/lib/database/repositories/UserRepository.js:56:32)\n    at NotificationService.isUserActive (/var/www/projects/project_notifications/lib/services/NotificationService.js:26:42)\n    at NotificationService.sendTelegram (/var/www/projects/project_notifications/lib/services/NotificationService.js:41:35)\n    at NotificationService.sendErrorNotification (/var/www/projects/project_notifications/lib/services/NotificationService.js:208:33)\n    at ErrorHandler.gracefulShutdown (/var/www/projects/project_notifications/lib/middleware/errorHandler.js:236:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","code":"POOL_CLOSED"}
[2025-07-09T21:42:18.975-04:00] [WARN] Usuario inactivo, no se enviarÃ¡ notificaciÃ³n | {"user":"andresjosehr"}
[2025-07-09T21:42:18.975-04:00] [INFO] [TELEGRAM] NotificaciÃ³n de error enviada | {"context":"graceful shutdown","user":"andresjosehr","success":false}
[2025-07-09T21:42:18.975-04:00] [INFO] Sistema cerrado correctamente